<mat-stepper #stepper
  class="responsive-stepper"
  [linear]="!(isEditMode$ | async)"
  [orientation]="(stepperOrientation | async)!"
  [selectedIndex]="selectedIndex"
  (selectionChange)="onStepChange($event)">

  <app-loading></app-loading>

  <!-- Step 1 -->
  <mat-step
    [completed]="getStepCompleted(0)"
    [editable]="getStepEditable(0)">
    <ng-template matStepLabel>
      (ISB) İhracat Sipariş Bildirimi Yükleme
      @if(isEditMode$ | async){
        <span class="edit-mode-badge">DÜZENLEME</span>
      }
    </ng-template>

    <app-invoice-upload
      #invoiceUploadComponent
      (invoiceUploaded)="invoiceUploaded()"
      (configurePallet)="configureEditModeInPalletComponent()">
    </app-invoice-upload>
  </mat-step>

  <!-- Step 2 -->
  <mat-step
    [completed]="getStepCompleted(1)"
    [editable]="getStepEditable(1)">
    <ng-template matStepLabel>
      Palet Kontrolü
      @if(isEditMode$ | async){
      <span class="edit-mode-badge">DÜZENLEME</span>
      }
    </ng-template>

    <app-pallet-control #palletControlComponent></app-pallet-control>
  </mat-step>

  <!-- Step 3 -->
  <mat-step
    [completed]="getStepCompleted(2)"
    [editable]="getStepEditable(2)">
    <ng-template matStepLabel>
      Sonuç Ekranı
      @if(isEditMode$ | async){
      <span class="edit-mode-badge">DÜZENLEME</span>
      }
    </ng-template>

    <app-result-step
      #resultStepComponent
      (shipmentCompleted)="onShipmentCompleted()">
    </app-result-step>
  </mat-step>
</mat-stepper>
